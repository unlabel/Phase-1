# Проектирование БД: Книжный магазин (1НФ)
Привет! Необходимо спроектировать базу данных для книжного магазина. Уже существующие данные собраны в папке `data`.

Используй нормализацию в проектировании — необходимо привести таблицу `books` к первой нормальной форме (1НФ).

## Первая нормальная форма (1НФ)
Таблица находится в первой нормальной форме, если соблюдены все условия:
1. порядок строк не имеет значения,
2. порядок столбцов не имеет значения,
3. нет повторяющихся строк,
4. каждая ячейка содержит единственное значение и ничего больше.

## Release 1. Спроектировать базу данных
Сверься с данными из файла `data/books.csv`. Приведи таблицу `books` к первой нормальной форме (1НФ). Какие атрибуты необходимы для таблицы `books`?

<!-- markdownlint-disable no-inline-html -->
<details>
<summary>Ответ</summary>
<p><b>books:</b> isbn, title, amount</p>
</details>
<!-- markdownlint-enable no-inline-html -->

Ответь на следующие вопросы:
1. Какие нарушения критериев 1НФ есть в исходных данных для таблицы `books`?
2. Какие проблемы возникли с исходными данными из-за этих нарушений? Как их разрешить?
    <!-- markdownlint-disable no-inline-html -->
    <details>
    <summary>Ответ</summary>
    <ul>
    <li>Строка с книгой "Выдох (сборник)" полностью продублирована. Это привело к избыточности данных и рассогласованию данных — теперь неизвестно, сколько экземпляров этой книги реально есть в наличии. Эти данные необходимо уточнять в магазине. Предположим, что заказчик ответил, что осталось 5 экземпляров этой книги.<br><br></li>
    <li>В CSV-файле хранятся избыточные данные по авторам и жанрам. Это привело к разному написанию имени Френка Герберта и опечатке в жанре "Обитаемого острова". Пока что достаточно исправить опечатку и использовать одинаковое написание имени автора.<br><br>Критерии 1НФ не требуют вынести авторов и жанры в отдельные таблицы, однако это может быть хорошей идеей. В дальнейшем мы изучим другие нормальные формы с более строгими критериями — и тогда подобное разнесение будет необходимо.</li>
    </ul>
    </details>
    <!-- markdownlint-enable no-inline-html -->
3. Как поступить с этими нарушениями?
4. Какие ограничения (constraints) нужно добавить, чтобы гарантировать отсутствие подобных нарушений в будущем?
5. Какой тип данных подходит для каждого атрибута таблицы `books`?
6. Какой первичный ключ выбрать для таблицы `books` — естественный или суррогатный? Простой или составной? Какие плюсы и минусы использования каждого типа первичного ключа?
7. Какие ещё таблицы нужно создать для хранения информации о книгах? Какие ограничения нужно в них добавить?

Нарисуй entity relationship diagram (ERD) для базы данных. Используй ручку и бумагу или любой другой инструмент для рисования диаграмм. Можно воспользоваться сервисом [drawSQL](https://drawsql.app/) — в каждой диаграмме можно создать до 15 таблиц бесплатно.

## Release 2. Написать SQL-запросы для создания и удаления таблиц(ы)
Работай в файле `sql/migration.sql`.

Используя дизайн базы данных, напиши SQL запросы для создания необходимых таблиц. Проверь, что запросы выполняются без ошибок.

Также напиши запросы для удаления необходимых таблиц. Проверь, что все запросы выполняются без ошибок — как на удаление, так и на создание таблиц(ы).

Сделай как минимум один коммит для этого релиза.

## Release 3. Написать SQL-запросы для заполнения таблиц(ы) данными и их очистки
Работай в файле `sql/seeder.sql`.

Напиши SQL запросы для заполнения таблиц(ы) исходными данными. Проверь, что запросы выполняются без ошибок.

Также напиши запросы для удаления созданных данных. Проверь, что все запросы выполняются без ошибок — как на удаление, так и на создание данных.

Сделай как минимум один коммит для этого релиза.

## Release 4. Написать SQL-запросы для выборки данных
Работай в файле `sql/queries.sql`.

Используй выборку данных с помощью SQL, чтобы ответить на эти вопросы:
1. Какие книги есть в наличии?
2. Каких книг нет в наличии?
3. Какие книги есть в наличии и их количество больше или равно 5?
4. Какие книги есть в наличии и их количество больше 5, но меньше 10?
5. Отсортируй все книги по количеству в наличии по убыванию — от большего к меньшему.
6. Отсортируй все книги по количеству в наличии по возрастанию — от меньшего к большему. Выведи только первые 5 книг.

Проверь, что запросы выполняются без ошибок.

Сделай как минимум один коммит для этого релиза.

## Release 5 (необязательный). Выбрать данные с соединением таблиц
Для выполнения этого релиза тебе понадобится разобраться с внешними ключами и оператором JOIN для соединения таблиц.

- [PostgresPro: 5.4.5. Внешние ключи](https://postgrespro.ru/docs/postgresql/15/ddl-constraints#DDL-CONSTRAINTS-FK)
- [PostgresPro: 2.6. Соединения таблиц](https://postgrespro.ru/docs/postgresql/15/tutorial-join)

Изучи вопросы ниже. Позволяет ли твой нынешний дизайн базы данных ответить на них? Если нет, то как это можно исправить?

1. Сколько экземпляров книг каждого автора есть в наличии? Выведи имена авторов и количество всех экземпляров.
2. Сколько книг каждого жанра есть в наличии? Выведи названия жанров и количество книг. Разные издания одной и той же книги считаются за одну книгу для этого запроса.

Напиши SQL запросы для этого релиза. Проверь, что запросы выполняются без ошибок. Сделай как минимум один коммит.
